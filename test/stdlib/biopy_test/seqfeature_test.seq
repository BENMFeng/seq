from Bio.SeqFeature import FeatureLocation, Position
from Bio.SeqFeature import CompoundLocation, UnknownPosition, SeqFeature
from Bio.SeqFeature import WithinPosition, BetweenPosition
from Bio.SeqFeature import OneOfPosition


####### Test FeatureLocation #######
@test
def test_eq_identical():
    """
    Test two identical locations are equal.
    """
    loc1 = FeatureLocation(23, 42, 1, '', '')
    loc2 = FeatureLocation(23, 42, 1, '', '')   
    assert loc1 == loc2

    loc1 = FeatureLocation(23, 42, -1, '', '')
    loc2 = FeatureLocation(23, 42, -1, '', '')
    assert loc1 == loc2

    loc1 = FeatureLocation(23, 42, -1, '', '')
    loc2 = FeatureLocation(23, 42, -1, '', '')
    assert loc1 == loc2

    # loc1 = FeatureLocation(Position(23, 1, 0), Position(42, 2, 0), 1, '', '')
    # loc2 = FeatureLocation(23, 42, 1, '', '')
    # print (loc1, loc2)

    loc1 = FeatureLocation(23, 42, 1, "foo", "bar")
    loc2 = FeatureLocation(23, 42, 1, "foo", "bar")
    assert loc1 == loc2
test_eq_identical()

@test
def test_eq_not_identical():
    """
    Test two different locations are not equal.
    """
    loc1 = FeatureLocation(22, 42, 1, '', '')
    loc2 = FeatureLocation(23, 42, 1, '', '')
    assert loc1 != loc2

    loc1 = FeatureLocation(23, 42, 1, '', '')
    loc2 = FeatureLocation(23, 43, 1, '', '')
    assert loc1 != loc2

    loc1 = FeatureLocation(23, 42, 1, '', '')
    loc2 = FeatureLocation(23, 42, -1, '', '')
    assert loc1 != loc2
    
    loc1 = FeatureLocation(23, 42, 1, 'foo', '')
    loc2 = FeatureLocation(23, 42, 1, 'bar', '')
    assert loc1 != loc2

    loc1 = FeatureLocation(23, 42, 1, 'foo', 'bar')
    loc2 = FeatureLocation(23, 42, 1, 'foo', 'baz')
    assert loc1 != loc2
test_eq_not_identical()

@test
# not finished
def test_start_before_end():
    expected = "must be greater than or equal to start location"
    print FeatureLocation(42, 23, 1, '', '')

test_start_before_end()

####### Test CompoundLocation #######

@test
def test_eq_identical1():
    loc1 = FeatureLocation(12, 17, 1, '', '') + FeatureLocation(23, 42, 1, '', '')
    loc2 = FeatureLocation(12, 17, 1, '', '') + FeatureLocation(23, 42, 1, '', '')
    assert loc1 == loc2

    loc1 = FeatureLocation(12, 17, 1, '', '') + FeatureLocation(23, 42, 1, '', '')
    loc2 = CompoundLocation([FeatureLocation(12, 17, 1, '', ''), FeatureLocation(23, 42, 1, '', '')], 'join')
    assert loc1 == loc2
test_eq_identical1()

@test
def test_eq_not_identical1():
    loc1 = FeatureLocation(12, 17, 1, '', '') + FeatureLocation(23, 42, 1, '', '')
    loc2 = FeatureLocation(12, 17, 1, '', '') + FeatureLocation(23, 42, 1, '', '') + FeatureLocation(50, 60, 1, '', '')
    assert loc1 != loc2

    loc1 = FeatureLocation(12, 17, 1, '', '') + FeatureLocation(23, 42, 1, '', '')
    loc2 = FeatureLocation(12, 17, -1, '', '') + FeatureLocation(23, 42, -1, '', '')
    assert loc1 != loc2

    loc1 = CompoundLocation([FeatureLocation(12, 17, 1, '', ''), FeatureLocation(23, 42, 1, '', '')], "join")
    loc2 = CompoundLocation([FeatureLocation(12, 17, 1, '', ''), FeatureLocation(23, 42, 1, '', '')], 'order')
    assert loc1 != loc2
test_eq_not_identical1()  
