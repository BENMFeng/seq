fastq('test/data/seqs.fastq') |> echo
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT

print '-'  # EXPECT: -
fasta('test/data/seqs.fasta') |> echo
# EXPECT: TCCTCCCCGTTCGCTGGACCCTTGGTCTATCTAGTCAAGAATTAACTCCCATTTAGTTGGCTGTTCGTCGATTACCCCTACTGGACCGTCGCAACGGCTCACGTGGAGGTCTTAGACCAAGAAAGCTACTGTATGCGGGGATATCACATCAGATTGCCAGGCGAGCAGCTCTAGCGTGACACGCCTAGACTCATTCGTTGTTCCTTGTCAATCCCAGGGGTCTCCACAGGGAGTGGATCGAGCTAATCACCGTTTCGAGTCCGTCAGGCGGAGAGTAGCAGTAAGTACAAACTTCTGCTAGTCGCTCTGCCACAACGTAGCCACCTAAGATTAACCCTGGAATTGTCCGGGCGGCATGATCCATCGAGGAGTTAGCGGGGACAGGGAGTTACCAGTCGAGACGTCCATGGTGGTGCTGCAATCCATGGATACCATCTCCTTGCCATTCCTAGGGACATCG
# EXPECT: TATGGGGTAGCATCATTAAGTGGGGAGGTAGACCAGGAGTTCGGTTCCCGGAGTTTCGTTAGTTCAGGTAGCGTGACCTCGTCTTAGTATGCAGTCGTGAAATAATAGACATTTCTGCCTGTCAGGTTGCACTAATCACACCCAGGCTGTTAACGAGGCGGCTCGTAGTATAAACGCTTTGGACTAGACTCGATACCTAGCGGCGCGCATTGATAAATGGTGCATCTATAGTAAAAGGCGTCCCAACCTGGGGACTTAGCGTTGAATACCCGTGCAAGGATCTCTAATCGGTTCTCAATGGCTGCCTGCTCTTTCTCTAAACGAGACTCTAATATCATGTGTGGTCCTTGCTTTCGGTCGAGAAAAAGCCTTTGATCGCATCCCAAACCGACATCTAAAAGCTTCATGTATGTCGGCAGCGAAAAAACGACCAAATAGAAGTCCCCTAACGGAGAATAGGCCGCCCACGACAGAACACCGCTTCGTCCT
# EXPECT: CCCGCTAGCCGTGCCTGATCCTCAACCAAGCTGGGTAAAGACAACCGTCTAATCATTAACTTACGTTGTTACGTCATTTTGCGCTTAAAATTGTCGCACCGGAATCCGTCGAGACTTCCCGAGACATGTCCCCTTAATAAATGTACGGTGTGACCTAACGATCGGATCACCGTCCGTGCTAAAACACACAACCGCTGCGTGACACCGACCGAACGTTACCGAAGGCTGTCCGCCTAACATCTATATTTGGCGGTAAAGAGGCGGTTCCGGCGGACTATAAAGTCACAGGCCACTGTTTCTTTGCAAGATATGGCTCTCTGTCAGGACCGCCCCCTAGGGTCAGCTCAAATAAGCTTGTCCCGGACTCCGTACTTCCAACAGAAAGGTGACCGCTACATTCTGCTATTGACCCCTCACACAACGTTCCCCCGCATGGCGTACGTGTTACCAGGGCGGTTGCGGCCTTACGTCGCCATAAGCACGTATATAAGTCACCCACT
# EXPECT: TGCCGTGACCACCCCGCGAGAATCTCATAATGATATCTCCAATCGAGTA

print '-'  # EXPECT: -
seqs('test/data/seqs.txt') |> echo
# EXPECT: GTCCTAAATTGTTGTACGAAAGAACGTGACAGAGGGAAGGCACTCGGCGTGGCTGAGAGTTGCGGCTACCGCACTGTTACACGGTATGCTAGTTAAAACTTGGAAGAGGGCAAAGCGACTATGCACTGTGGCTGGATCGCTATGACCCCTG
# EXPECT: GACGTGTGGAGTAAGCATAAGTCACTATATCAACAAGCCCGCAACAATACTTGTAGAGAATCTGAACCGGCTAGGCGCTCAACGCTACAGGGTGTCATTTCGTACCCCTAACACTGCTATTCGTTTCGGAAGAGGCACCTCGGTGAAGAAA
# EXPECT: GAAGCTGGAGCGAAGTCGATGTTTTTGCTGTACCAGGCGTGAGTTTGTAGATAAGCGGTCTGATACCGCAGAAGCAGGGTACAGTATAGACACGGGTTAAGTCGAGAGACAGGTCAAACAATTAACGCCAAAGAGGTCCCAGTCAGGAGCT
# EXPECT: AATGAAGTGGGGTAATTATGATTCTATAAATTTGTAGGGAAATGGGTTTAGCGCCTGAACGACAAGCGATAGATTATGGGCTGAGGAATAGTAGTTACTCCGCGGGCGGCCGCATTCGATATTTTGCGTCATCATAGATCAAGTTTCCGGG

print '-'  # EXPECT: -
sam('test/data/toy.sam') |> echo
# EXPECT: TTAGATAAAGAGGATACTG
# EXPECT: AAAAGATAAGGGATAAA
# EXPECT: AGCTAA
# EXPECT: ATAGCTCTCAGC
# EXPECT: TAGGC
# EXPECT: CAGCGCCAT
# EXPECT: AGGTTTTATAAAACAAATAA
# EXPECT: GGTTTTATAAAACAAATAATT
# EXPECT: TTATAAAACAAATAATTAAGTCTACA
# EXPECT: CAAATAATTAAGTCTACAGAGCAAC
# EXPECT: AATAATTAAGTCTACAGAGCAACT
# EXPECT: TAATTAAGTCTACAGAGCAACTA

print '-'  # EXPECT: -
bam('test/data/toy.bam') |> echo
# EXPECT: TTAGATAAAGAGGATACTG
# EXPECT: AAAAGATAAGGGATAAA
# EXPECT: AGCTAA
# EXPECT: ATAGCTCTCAGC
# EXPECT: TAGGC
# EXPECT: CAGCGCCAT
# EXPECT: AGGTTTTATAAAACAAATAA
# EXPECT: GGTTTTATAAAACAAATAATT
# EXPECT: TTATAAAACAAATAATTAAGTCTACA
# EXPECT: CAAATAATTAAGTCTACAGAGCAAC
# EXPECT: AATAATTAAGTCTACAGAGCAACT
# EXPECT: TAATTAAGTCTACAGAGCAACTA

print '-'  # EXPECT: -
cram('test/data/toy.cram') |> echo
# EXPECT: TTAGATAAAGAGGATACTG
# EXPECT: AAAAGATAAGGGATAAA
# EXPECT: AGCTAA
# EXPECT: ATAGCTCTCAGC
# EXPECT: TAGGC
# EXPECT: CAGCGCCAT
# EXPECT: AGGTTTTATAAAACAAATAA
# EXPECT: GGTTTTATAAAACAAATAATT
# EXPECT: TTATAAAACAAATAATTAAGTCTACA
# EXPECT: CAAATAATTAAGTCTACAGAGCAAC
# EXPECT: AATAATTAAGTCTACAGAGCAACT
# EXPECT: TAATTAAGTCTACAGAGCAACTA

def print1(r):
    print r.name()
    print r.read()
    print r.qual()

print '-'  # EXPECT: -
FASTQ('test/data/seqs.fastq').all() |> print1
# EXPECT: @SL-HXF:348:HKLFWCCXX:1:2101:15676:57231:CACCAAAAGTACATGA
# EXPECT: GTGCACAGAAAAAAAGGTTAAATTGAAAAGTAAATATGATAGAAATGATTGCAAATGTTGGCAAACCACTAAATCGACTAAAACTTGAATAAAAGTAAAAATCATCCATGTCATTTATAAAGCGACTCAACTAAAGCATAAGGATATAAGA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKFKKKKKKKFKKFKKKKFKKKFK<,AAAFKFKKFAFKKA,,,A<FFAFFK<AAKFFKKKFK,<,,7F<
# EXPECT: @SL-HXF:348:HKLFWCCXX:1:2121:24495:55877:CACCAAAAGTACATGA
# EXPECT: TATATTCGTGTCCACTTCATGATTCCATTCAATTCCATCTAATGTTGATTCCATTTGATTCCATTTGATGATTCAGTTCGATTCCTTGCAATGATTCCCTACGATTCCTTTCTATGATGATTCCATTCGATTCCATTCATTGATGATTTCA
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKKKKKKKKKKKFKKKKKKKKKKKKFKKKKKKKKKFFK7AAFKKFKKKKKFAKKKFKKFKKKF7A7F<<KKF,
# EXPECT: @SL-HXF:348:HKLFWCCXX:1:2220:28361:38491:CACCAAAAGTACATGA
# EXPECT: CCTGCATCACGACGACCGCCGCCACCGTCAGCCCAGCCCACCCACTGCACTCCACCCTCAGCACCACAGTGAGCCCGAATACCACCACCCCCCCCACCACCACCACCACACAAACAACCACCACCACCACAACCACCCTCACCACCATCAC
# EXPECT: ,A,<,A,F,,,,,,,,,,(((,,(<((7,A,A,(,((((,,(7,,,,,,F,,FK,F7<,,,7F,FFF7,,,77,,(((,,,7F,FF,A77AF7FK(((,<,<,,,,,<<,,,,,,,<A7AF,7A<KKA<F,,,7,,<(,,,,,,,,,,,,,
# EXPECT: @SL-HXF:348:HKLFWCCXX:4:1106:4553:37893:CACCAAAAGTACATGA
# EXPECT: TCAATTCGATTCTATTCGATGATGATTCCATTGGATTTCACTTGATGATTCTATTCGATTCCATTCAATGATGATTCACTTCTCGTCCATTGGATGATTCCATTTCATTCCATTCTATGATGATTCCATTCGATTCCATTTGATGATAATT
# EXPECT: AAFFFKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKKFKKKKFKKKKKKFKKK7AFFKAFKKKKK,FKKFKAFFA7<<,FFAFKFAF7FKK77<,,,,,,,,,,<F7A,<AK,AFFK<<KKF<,AA7<F,,7

def print2(r):
    print r.name()
    print r.seq()

print '-'  # EXPECT: -
FASTA('test/data/seqs.fasta').all() |> print2
# EXPECT: chrA
# EXPECT: TCCTCCCCGTTCGCTGGACCCTTGGTCTATCTAGTCAAGAATTAACTCCCATTTAGTTGGCTGTTCGTCGATTACCCCTACTGGACCGTCGCAACGGCTCACGTGGAGGTCTTAGACCAAGAAAGCTACTGTATGCGGGGATATCACATCAGATTGCCAGGCGAGCAGCTCTAGCGTGACACGCCTAGACTCATTCGTTGTTCCTTGTCAATCCCAGGGGTCTCCACAGGGAGTGGATCGAGCTAATCACCGTTTCGAGTCCGTCAGGCGGAGAGTAGCAGTAAGTACAAACTTCTGCTAGTCGCTCTGCCACAACGTAGCCACCTAAGATTAACCCTGGAATTGTCCGGGCGGCATGATCCATCGAGGAGTTAGCGGGGACAGGGAGTTACCAGTCGAGACGTCCATGGTGGTGCTGCAATCCATGGATACCATCTCCTTGCCATTCCTAGGGACATCG
# EXPECT: chrB
# EXPECT: TATGGGGTAGCATCATTAAGTGGGGAGGTAGACCAGGAGTTCGGTTCCCGGAGTTTCGTTAGTTCAGGTAGCGTGACCTCGTCTTAGTATGCAGTCGTGAAATAATAGACATTTCTGCCTGTCAGGTTGCACTAATCACACCCAGGCTGTTAACGAGGCGGCTCGTAGTATAAACGCTTTGGACTAGACTCGATACCTAGCGGCGCGCATTGATAAATGGTGCATCTATAGTAAAAGGCGTCCCAACCTGGGGACTTAGCGTTGAATACCCGTGCAAGGATCTCTAATCGGTTCTCAATGGCTGCCTGCTCTTTCTCTAAACGAGACTCTAATATCATGTGTGGTCCTTGCTTTCGGTCGAGAAAAAGCCTTTGATCGCATCCCAAACCGACATCTAAAAGCTTCATGTATGTCGGCAGCGAAAAAACGACCAAATAGAAGTCCCCTAACGGAGAATAGGCCGCCCACGACAGAACACCGCTTCGTCCT
# EXPECT: chrC
# EXPECT: CCCGCTAGCCGTGCCTGATCCTCAACCAAGCTGGGTAAAGACAACCGTCTAATCATTAACTTACGTTGTTACGTCATTTTGCGCTTAAAATTGTCGCACCGGAATCCGTCGAGACTTCCCGAGACATGTCCCCTTAATAAATGTACGGTGTGACCTAACGATCGGATCACCGTCCGTGCTAAAACACACAACCGCTGCGTGACACCGACCGAACGTTACCGAAGGCTGTCCGCCTAACATCTATATTTGGCGGTAAAGAGGCGGTTCCGGCGGACTATAAAGTCACAGGCCACTGTTTCTTTGCAAGATATGGCTCTCTGTCAGGACCGCCCCCTAGGGTCAGCTCAAATAAGCTTGTCCCGGACTCCGTACTTCCAACAGAAAGGTGACCGCTACATTCTGCTATTGACCCCTCACACAACGTTCCCCCGCATGGCGTACGTGTTACCAGGGCGGTTGCGGCCTTACGTCGCCATAAGCACGTATATAAGTCACCCACT
# EXPECT: chrD
# EXPECT: TGCCGTGACCACCCCGCGAGAATCTCATAATGATATCTCCAATCGAGTA

def print3(r):
    print r.tid(), r.pos(), r.name(), r.read(), r.cigar()
    aux = r.aux('XX')
    if aux:
        print [aux.B2i(i) for i in range(aux.B_len())]

print '-'  # EXPECT: -
SAM('test/data/toy.sam').all() |> print3
# EXPECT: 0 6 r001 TTAGATAAAGAGGATACTG 8M4I4M1D3M
# EXPECT: [12561, 2, 20, 112]
# EXPECT: 0 8 r002 AAAAGATAAGGGATAAA 1S2I6M1P1I1P1I4M2I
# EXPECT: 0 8 r003 AGCTAA 5H6M
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
BAM('test/data/toy.bam').all() |> print3
# EXPECT: 0 6 r001 TTAGATAAAGAGGATACTG 8M4I4M1D3M
# EXPECT: [12561, 2, 20, 112]
# EXPECT: 0 8 r002 AAAAGATAAGGGATAAA 1S2I6M1P1I1P1I4M2I
# EXPECT: 0 8 r003 AGCTAA 5H6M
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
CRAM('test/data/toy.cram').all() |> print3
# EXPECT: 0 6 r001 TTAGATAAAGAGGATACTG 8M4I4M1D3M
# EXPECT: [12561, 2, 20, 112]
# EXPECT: 0 8 r002 AAAAGATAAGGGATAAA 1S2I6M1P1I1P1I4M2I
# EXPECT: 0 8 r003 AGCTAA 5H6M
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
BAM('test/data/toy.bam', 'ref2').all() |> print3
# EXPECT: 1 0 x1 AGGTTTTATAAAACAAATAA 20M
# EXPECT: 1 1 x2 GGTTTTATAAAACAAATAATT 21M
# EXPECT: 1 5 x3 TTATAAAACAAATAATTAAGTCTACA 9M4I13M
# EXPECT: 1 9 x4 CAAATAATTAAGTCTACAGAGCAAC 25M
# EXPECT: 1 11 x5 AATAATTAAGTCTACAGAGCAACT 24M
# EXPECT: 1 13 x6 TAATTAAGTCTACAGAGCAACTA 23M

print '-'  # EXPECT: -
CRAM('test/data/toy.cram', 'ref:30').all() |> print3
# EXPECT: 0 15 r004 ATAGCTCTCAGC 6M14N1I5M
# EXPECT: 0 28 r003 TAGGC 6H5M
# EXPECT: 0 36 r001 CAGCGCCAT 9M
